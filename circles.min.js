const PERC="percentage",NUMB="number",TIME="time",rightTop="rightTop",leftTop="leftTop";window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;function degToRad(a){return a*Math.PI/180}function STimeToTimeStamp(a){var b=0;if(/^\d{1,3}:\d{1,2}:\d{1,2}$/.test(a))for(var c=a.split(":").reverse(),d=0;d<c.length;d++)b+=parseInt(c[d])*Math.pow(60,d);return b}function withZero(a,b){var c=a+"";if(!isNaN(parseInt(a))&&0<=b)for(var d=(a+"").length;d<b;d++)c="0"+c;return c}function TimeStampToString(a){var b="";if(!isNaN(parseInt(a))&&0<a){for(var c=2;1<=c;c--)if(a>Math.floor(a/Math.pow(60,c))){var d=Math.floor(a/Math.pow(60,c));b+=withZero(window.String(d),2)+":",a-=Math.floor(d*Math.pow(60,c))}else b+="0:";0<=a&&(b+=withZero(window.String(Math.floor(a)),2))}return b}function getCordFromAngle(a,b,c){var d={x:Math.floor(a.x+b*Math.cos(c)),y:Math.floor(a.y+b*Math.sin(c))};return d}function Circle(a,b,c){this.dims={w:a.offsetWidth,h:a.offsetHeight},this.style=b,this.el=a,this.content=a.getContext("2d"),this.perc=c,this.oldPerc=0,this.currentTime=0,this.drawing=!1,this.getRayon=function(){var d=this.dims.w/2;return"number"==typeof this.style.radius&&1<this.style.radius&&(d=this.style.radius),this.style.hasOwnProperty("lineForce")&&1<this.style.lineForce?d-this.style.lineForce/2:d},this.porcToRad=function(d){if(this.style.hasOwnProperty("maxValue"))return this.style.hasOwnProperty("maxAngle")?degToRad(this.style.maxAngle)*d/this.style.maxValue:2*Math.PI*d/this.style.maxValue},this.getTextMiddle=function(d){var e=this.content.measureText(d).width,f=10;if(this.style.hasOwnProperty("valueStyle")&&""!=this.style.valueStyle.font){var g=/\d+px/.exec(this.style.valueStyle.font)[0].split(/[A-z]+/);null!=g&&(f=parseInt(g))}return{x:Math.round(e/2),y:Math.round(f)/2}},this.setCircleStyle=function(){this.content.lineWidth=1<this.style.lineForce?this.style.lineForce:1,this.content.strokeStyle="string"==typeof this.style.color&&""!=this.style.color?this.style.color:"black"},this.setTextStyle=function(){this.content.fillStyle="black",this.content.font="10px arial",this.style.hasOwnProperty("valueStyle")&&(""!=this.style.valueStyle.font&&(this.content.font=this.style.valueStyle.font),""!=this.style.valueStyle.color&&(this.content.fillStyle=this.style.valueStyle.color))},this.resetCanvasParam=function(){this.content.font="10px arial",this.content.fillStyle="black",this.content.strokeStyle="black",this.content.lineWidth=1},this.writeConrnerValue=function(d){this.resetCanvasParam();var e={x:0,y:10};this.style.atCorner==rightTop&&(e.x=this.dims.w-this.content.measureText(d).width),this.style.hasOwnProperty("cornerValueStyle")&&("string"==typeof this.style.cornerValueStyle.font&&""!=this.style.cornerValueStyle.font&&(this.content.font=this.style.cornerValueStyle.font,!isNaN(parseInt(/\d+px/.exec(this.style.cornerValueStyle.font)[0].split(/[A-z]+/)[0]))&&(e.y=parseInt(/\d+px/.exec(this.style.cornerValueStyle.font)[0].split(/[A-z]+/)[0]))),"string"==typeof this.style.cornerValueStyle.color&&this.style.cornerValueStyle.color&&(this.content.fillStyle=this.style.cornerValueStyle.color)),this.content.fillText(d,e.x,e.y)},this.drawBorder=function(d,e){this.content.beginPath();var f=2*Math.PI,g=1;1<this.style.lineForce&&(g+=this.style.lineForce),"number"==typeof this.style.maxAngle&&0<this.style.maxAngle&&(f=degToRad(this.style.maxAngle)),"number"==typeof this.style.withBorder.lineForce&&1<this.style.withBorder.lineForce&&(g+=this.style.withBorder.lineForce),this.content.lineWidth=g,this.content.strokeStyle="string"==typeof this.style.withBorder.color&&""!=this.style.withBorder.color?this.style.withBorder.color:"gray",this.content.arc(d.x,d.y,this.getRayon(),e,e+f),this.content.stroke()},this.draw=function(d){!1==this.drawing&&(this.drawing=!0),this.content.beginPath(),this.clearCanvas(),this.resetCanvasParam();var e=0,f=this.porcToRad(d),g={x:this.dims.w/2,y:this.dims.h/2};this.style.hasOwnProperty("startAngle")&&(e=degToRad(this.style.startAngle)),180>=this.style.maxAngle?(g.y=this.dims.h,this.halfCircle=!0):this.halfCircle=!1,"object"==typeof this.style.withBorder&&this.style.hasOwnProperty("withBorder")&&this.drawBorder(g,e),this.resetCanvasParam(),this.setCircleStyle(),this.content.beginPath(),this.content.arc(g.x,g.y,this.getRayon(),e,e+f),this.content.stroke(),!0==this.style.fillCirclRest&&this.fillCircleRest(e+f,g),!0==this.style.withEndLine&&this.drawEndLine(e+f),!0==this.style.withValue&&this.writeText(d),!0==this.style.cornerValue&&/rightTop|leftTop/.test(this.style.atCorner)&&this.writeConrnerValue(this.getValueByType(d+"")),!0==this.style.withAnimation&&this.animate()},this.animate=function(){if(this.style.hasOwnProperty("animationDuration")||(this.style.animationDuration=1e3),this.currentTime<=this.style.animationDuration&&this.oldPerc!=this.perc){var d=0;d=this.oldPerc<this.perc?this.linearAnimation(this.oldPerc,this.perc,this.style.animationDuration,this.currentTime):this.linearAnimation(this.oldPerc,this.perc,this.style.animationDuration,this.currentTime),window.requestAnimationFrame(this.draw.bind(this,d)),this.currentTime+=this.getAnimationStep()}else this.oldPerc=this.perc,this.currentTime=0},this.getAnimationStep=function(){for(var d=10;0<d;d--)if(0==this.style.animationDuration%d)return d},this.linearAnimation=function(d,e,f,g){return Math.round(g*(e/f-d/f)+this.oldPerc)},this.clearCanvas=function(){this.content.clearRect(0,0,this.dims.w,this.dims.h)},this.getValueByType=function(d){return this.style.valueType==PERC?d+="%":this.style.valueType==TIME&&(d=TimeStampToString(parseInt(d))),d},this.writeText=function(d){this.setTextStyle();var e=this.getValueByType(d+"");if(this.style.hasOwnProperty("valueStyle")&&/fontAwesome/i.test(this.style.valueStyle.font))if("string"==typeof this.style.icon&&""!=this.style.icon)e=this.style.icon;else return;var f=this.getTextMiddle(e+"");this.halfCircle?this.content.fillText(e,this.dims.w/2-f.x,this.dims.h-f.y/2):this.content.fillText(e,this.dims.w/2-f.x,this.dims.h/2+f.y/2)},this.drawEndLine=function(d){this.resetCanvasParam();var e={x:this.dims.w/2,y:this.dims.w/2},f=0;this.content.strokeStyle="white",this.style.hasOwnProperty("lineEndStyle")&&(1<this.style.lineEndStyle.lineForce&&(this.content.lineWidth=this.style.lineEndStyle.lineForce),"string"==typeof this.style.lineEndStyle.color&&""!=this.style.lineEndStyle.color&&(this.content.strokeStyle=this.style.lineEndStyle.color)),"number"==typeof this.style.lineForce&&1<this.style.lineForce&&(f+=this.style.lineForce/2);var g=getCordFromAngle(e,this.getRayon()+f,d),h=getCordFromAngle(e,this.getRayon()-f,d);this.content.beginPath(),this.content.moveTo(g.x,g.y),this.content.lineTo(h.x,h.y),this.content.stroke()},this.fillCircleRest=function(d,e){this.content.beginPath(),this.resetCanvasParam(),this.content.strokeStyle="gray",this.style.hasOwnProperty("fillRestStyle")&&("string"==typeof this.style.fillRestStyle.color&&""!=this.style.fillRestStyle.color&&(this.content.strokeStyle=this.style.fillRestStyle.color),0<this.style.fillRestStyle.lineForce&&(this.content.lineWidth=this.style.fillRestStyle.lineForce));var f=2*Math.PI;this.style.hasOwnProperty("maxAngle")&&(f=degToRad(this.style.maxAngle)),0<this.style.startAngle&&(f+=degToRad(this.style.startAngle)),this.content.arc(e.x,e.y,this.getRayon(),d,f),this.content.stroke()},this.setValue=function(d){this.perc=d},this.updateCircleStyle=function(d){this.style=d},this.startDrawing=function(){return this.currentTime=0,!0!=this.style.withAnimation&&(this.oldPerc=this.perc),this.draw(this.oldPerc),this}}